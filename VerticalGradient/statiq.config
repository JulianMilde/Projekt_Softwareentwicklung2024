using Statiq.Common;
using Statiq.Markdown;
using Statiq.Core;
using System.Text;

public class MyConfig : Configurator
{
    public override void Configure(IDictionary<string, object> settings)
    {
        // Einstellungen für Statiq
        settings[Keys.InputFiles] = "Program.cs, AnomalyAnalyzer.cs"; // Spezifische Auswahl der Dateien
        settings[Keys.UseScriptNames] = true;

        // Pipeline zur Generierung der README.md
        Pipelines.Add("ReadMePipeline",
            new ExecuteConfig(Config.FromDocument((doc, ctx) =>
            {
                var content = new StringBuilder();

                // Titel und Einführung
                content.AppendLine("# Vertikalgradientenprogramm");
                content.AppendLine("Dieses Programm analysiert magnetische Anomalien, indem es ein Diagramm des Vertikalgradienten erstellt und eine Tiefenberechnung der Anomalie vornimmt.");

                // Verwendung
                content.AppendLine("## Verwendung");
                content.AppendLine("1. Geben Sie den Pfad zur CSV-Datei ein.");
                content.AppendLine("2. Starten Sie das Programm, um die Analyse der Anomalie durchzuführen und ein Diagramm des Vertikalgradienten zu generieren.");

                // Beispielhafter Code-Schnipsel
                content.AppendLine("```csharp");
                content.AppendLine("static void Main(string[] args)");
                content.AppendLine("{");
                content.AppendLine("    // Beispielcode hier...");
                content.AppendLine("}");
                content.AppendLine("```");

                // Hinweis zur Installation von Abhängigkeiten
                content.AppendLine("## Installation");
                content.AppendLine("Stellen Sie sicher, dass Sie .NET 8.0.x installiert haben.");
                content.AppendLine("```bash");
                content.AppendLine("dotnet build");
                content.AppendLine("dotnet run");
                content.AppendLine("```");

                // Abschnitt über die Tests
                content.AppendLine("## Tests");
                content.AppendLine("Um die Tests auszuführen, verwenden Sie den folgenden Befehl:");
                content.AppendLine("```bash");
                content.AppendLine("dotnet test");
                content.AppendLine("```");

                return ctx.CreateDocument("README.md", content.ToString());
            })),
            new RenderMarkdown()
        );

        // Ausgabepfad für die README.md
        settings[Keys.OutputPath] = "README.md";
    }
}
